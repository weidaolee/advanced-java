#+TITLE: AQS EXCLUSIVE mode 下的獲取與釋放
EXCLUSIVE mode 的 template method 入口方法有:
#+begin_src java
public final void acquire(int arg);
public final void acquireInterruptibly(int arg);
public final boolean tryAcquireNanos(int arg, long nanosTimeout);

public final boolean release(int arg);
#+end_src
* acquire
以下是 acquire 的 source code:
#+begin_src java
    /**
     * Acquires in exclusive mode, ignoring interrupts.  Implemented
     * by invoking at least once {@link #tryAcquire},
     * returning on success.  Otherwise the thread is queued, possibly
     * repeatedly blocking and unblocking, invoking {@link
     * #tryAcquire} until success.  This method can be used
     * to implement method {@link Lock#lock}.
     *
     * @param arg the acquire argument.  This value is conveyed to
     *        {@link #tryAcquire} but is otherwise uninterpreted and
     *        can represent anything you like.
     */
    public final void acquire(int arg) {
        if (!tryAcquire(arg) &&
            acquireQueued(addWaiter(Node.EXCLUSIVE), arg))
            selfInterrupt();
    }
#+end_src

1. tryAcquire
   tryAcquire(arg) 方法首先被調用, 實現它是 Sync 的職責, 實現的邏輯基本上是以 CAS 的方式 acquire, 如果 tryAcquire return true 表示 acquire 已經成功
2. addWaiter
   當 tryAcquire return false 時, 才有可能執行 addWaiter。 addWaiter 的責任是將要加入 wait queue 的 Node 準備好, 並以 CAS 的方式加入 wait queue 的 tail
3. acquireQueued
   在 Node 成功加入 wait queue 的 tail 後
